:mod:`diffbayes.base._kalman_filter_base`
=========================================

.. py:module:: diffbayes.base._kalman_filter_base

.. autoapi-nested-parse::

   Private module; avoid importing from directly.



Module Contents
---------------

Classes
~~~~~~~

.. autoapisummary::

   diffbayes.base._kalman_filter_base.KalmanFilterBase



.. py:class:: KalmanFilterBase(*, dynamics_model: DynamicsModel, measurement_model: KalmanFilterMeasurementModel, **unused_kwargs)

   Bases: :class:`diffbayes.base._filter.Filter`, :class:`abc.ABC`

   .. autoapi-inheritance-diagram:: diffbayes.base._kalman_filter_base.KalmanFilterBase
      :parts: 1
      :private-bases:

   Base class for a generic Kalman-style filter. Parameterizes beliefs with a mean
   and covariance.

   Subclasses should override _predict_step() and _update_step().

   .. attribute:: dynamics_model
      

      Forward model.

      :type: diffbayes.base.DynamicsModel


   .. attribute:: measurement_model
      

      Measurement model.

      :type: diffbayes.base.KalmanFilterMeasurementModel


   .. method:: forward(self, *, observations: types.ObservationsTorch, controls: types.ControlsTorch) -> types.StatesTorch

      Kalman filter forward pass, single timestep.

      :param observations: Observation inputs. Should be either a
                           dict of tensors or tensor of shape ``(N, ...)``.
      :type observations: dict or torch.Tensor
      :param controls: Control inputs. Should be either a dict of
                       tensors or tensor of shape ``(N, ...)``.
      :type controls: dict or torch.Tensor

      :returns: *torch.Tensor* -- Predicted state for each batch element. Shape should
                be ``(N, state_dim).``


   .. method:: initialize_beliefs(self, *, mean: types.StatesTorch, covariance: types.CovarianceTorch) -> None

      Set filter belief to a given mean and covariance.

      :param mean: Mean of belief. Shape should be ``(N, state_dim)``.
      :type mean: torch.Tensor
      :param covariance: Covariance of belief. Shape should be
                         ``(N, state_dim, state_dim)``.
      :type covariance: torch.Tensor


   .. method:: belief_mean(self) -> types.StatesTorch
      :property:

      Posterior mean. Shape should be ``(N, state_dim)``.


   .. method:: belief_covariance(self) -> types.CovarianceTorch
      :property:

      Posterior covariance. Shape should be ``(N, state_dim, state_dim)``.


   .. method:: _predict_step(self, *, controls: types.ControlsTorch) -> None
      :abstractmethod:

      Kalman filter predict step.

      Computes $\mu\ *{t | t - 1}$, $\Sigma*\ {t | t - 1}$ from $\mu\ *{t - 1 | t - 1}$,
      $\Sigma*\ {t - 1 | t - 1}$.

      :keyword controls: Control inputs.
      :kwtype controls: dict or torch.Tensor


   .. method:: _update_step(self, *, observations: types.ObservationsTorch) -> None
      :abstractmethod:

      Kalman filter measurement update step.

      Nominally, computes $\mu\ *{t | t}$, $\Sigma*\ {t | t}$ from $\mu\ *{t | t - 1}$,
      $\Sigma*\ {t | t - 1}$.

      Updates ``self.belief_mean`` and ``self.belief_covariance``.

      :keyword observations: Observation inputs.
      :kwtype observations: dict or torch.Tensor



